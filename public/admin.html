<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Getty Admin Dashboard</title>
    <meta name="description" content="App for Odysee streamers to manage tips, goals, and chat.">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="shortcut icon" href="/assets/getty-fav.png" />
    <link rel="stylesheet" href="/css/output.css">
    <link rel="stylesheet" href="/css/admin.css">
</head>
<body>
<div class="admin-container">
    <header class="admin-header">
        <div style="display: flex; align-items: center; gap: 15px;">
            <img src="/assets/getty.png" alt="Odysee Logo" style="height: 40px;">
            <h1>Administration</h1>
        </div>
        <nav>
            <a href="/">Go to the homepage</a>
        </nav>
    </header>
            <section class="admin-section system-status">
                <h2>System Status</h2>
                <div class="status-grid">
                    <div class="status-item">
                        <h3>Last tip</h3>
                        <p class="status-value" id="last-tip-status">Active</p>
                    </div>
                    <div class="status-item">
                        <h3>Notifications</h3>
                        <p class="status-value" id="tip-widget-status">Active</p>
                    </div>
                    <div class="status-item">
                        <h3>Tip goal</h3>
                        <p class="status-value" id="tip-goal-status">Active</p>
                    </div>
                    <div class="status-item">
                        <h3>Chat</h3>
                        <p class="status-value" id="chat-status">Inactive</p>
                    </div>
                </div>
                <button class="refresh-btn" id="refresh-status">Update Status</button>
            </section>
        <main class="admin-sections">
            <section class="admin-section">
                <h2>Last Tip</h2>
                <div class="form-group">
                    <label for="wallet-address">AR Address:</label>
                    <input type="text" id="wallet-address" value="<%= WALLET_ADDRESS %>">
                </div>
                <button class="save-btn" data-module="lastTip">Save</button>
                
                <div class="widget-card" style="margin-top: 20px;">
                    <h3 style="color: var(--secondary-color); margin-bottom: 10px;">OBS Integration</h3>
                    <div class="form-group">
                        <label>Last Tip Widget URL:</label>
                        <div style="display: flex; align-items: center;">
                            <input type="text" id="last-tip-url" readonly style="flex-grow: 1; background: var(--darker-bg);">
                            <button class="copy-btn" onclick="copyToClipboard('last-tip-url')">
                                <svg viewBox="0 0 24 24" width="16" height="16">
                                    <path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" />
                                </svg>
                                Copy
                            </button>
                        </div>
                    </div>
                </div>
            </section>
            
            <section class="admin-section">
                <h2>Tip goal</h2>
                <div class="form-group">
                    <label for="goal-amount">Monthly Goal (AR):</label>
                    <input type="number" id="goal-amount" value="10">
                </div>
                <div class="form-group">
                    <label for="starting-amount">Initial Amount (AR):</label>
                    <input type="number" id="starting-amount" value="0">
                </div>
                <button class="save-btn" data-module="tipGoal">Save</button>
                
                <div class="widget-card" style="margin-top: 20px;">
                    <h3 style="color: var(--secondary-color); margin-bottom: 10px;">OBS Integration</h3>
                    <div class="form-group">
                        <label>Tip Goal Widget URL:</label>
                        <div style="display: flex; align-items: center;">
                            <input type="text" id="tip-goal-url" readonly style="flex-grow: 1; background: var(--darker-bg);">
                            <button class="copy-btn" onclick="copyToClipboard('tip-goal-url')">
                                <svg viewBox="0 0 24 24" width="16" height="16">
                                    <path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" />
                                </svg>
                                Copy
                            </button>
                        </div>
                    </div>
                </div>
            </section>

                <section class="admin-section">
                <h2>Tip Notification</h2>

                <div class="widget-card" style="margin-top: 20px;">
                    <div class="form-group">
                        <label>Notification Widget URL:</label>
                        <div style="display: flex; align-items: center;">
                            <input type="text" id="tip-notification-url" readonly style="flex-grow: 1; background: var(--darker-bg);">
                            <button class="copy-btn" onclick="copyToClipboard('tip-notification-url')">
                                <svg viewBox="0 0 24 24" width="16" height="16">
                                    <path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" />
                                </svg>
                                Copy
                            </button>
                        </div>
                    </div>
                </div>
            </section>
            
            <section class="admin-section">
                <h2>Live Chat</h2>
                <div class="form-group">
                    <label for="chat-url">Chat URL:</label>
                    <input type="text" id="chat-url" placeholder="wss://sockety.odysee.tv/ws/commentron?id=xxx">
                </div>
                <button class="save-btn" data-module="chat">Save</button>
                
                <div class="widget-card" style="margin-top: 20px;">
                    <h3 style="color: var(--secondary-color); margin-bottom: 10px;">OBS Integration</h3>
                    <div class="form-group">
                        <label>Chat Widget URL:</label>
                        <div style="display: flex; align-items: center;">
                            <input type="text" id="obs-chat-url" readonly style="flex-grow: 1; background: var(--darker-bg);">
                            <button class="copy-btn" onclick="copyToClipboard('obs-chat-url')">
                                <svg viewBox="0 0 24 24" width="16" height="16">
                                    <path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" />
                                </svg>
                                Copy
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <section class="admin-section external-notifications-section">
                <h2>External Notifications</h2>
                
                <div class="form-group">
                    <label for="discord-webhook">Discord Webhook URL:</label>
                    <input type="text" id="discord-webhook" placeholder="https://discord.com/api/webhooks/...">
                </div>
                
                <div class="form-group">
                    <label for="telegram-bot-token">Telegram Bot Token:</label>
                    <input type="text" id="telegram-bot-token" placeholder="123456789:ABCdefGhIJKlmNoPQRsTUVwxyZ">
                </div>
                
                <div class="form-group">
                    <label for="telegram-chat-id">Telegram Chat ID:</label>
                    <input type="text" id="telegram-chat-id" placeholder="-1001234567890">
                </div>
                
                <div class="form-group">
                    <label for="notification-template">Notification Template:</label>
                    <textarea id="notification-template" rows="4">ðŸŽ‰ New tip from {from}: {amount} AR (${usd}) - "{message}"</textarea>
                    <div class="template-vars-hint">
                        <small>Available variables: <code>{from}</code>, <code>{amount}</code>, <code>{usd}</code>, <code>{message}</code></small>
                    </div>
                </div>
                
                <button class="save-btn" data-module="externalNotifications">Save</button>
            </section>
        </main>
    </div>
        <footer class="py-6 border-t border-border text-center text-sm">
        <div class="max-w-7xl mx-auto px-6">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="mb-4 md:mb-0">
                    <p class="font-bold">Â© 2025 Getty - <a href="https://opensource.org/licenses/MIT" target="_blank" class="hover:text-primary-200 transition-colors font-bold">MIT License</a></p>
                </div>
                <div class="flex space-x-4">
                    <a href="https://odysee.com" target="_blank" class="hover:text-primary-200 transition-colors font-bold">Odysee</a>
                    <span>|</span>
                    <a href="https://github.com/es-socrates/getty" target="_blank" class="hover:text-primary-200 transition-colors font-bold">GitHub</a>
                    <span>|</span>
                    <p class="font-bold">This is an independent project; it is not an official Odysee product.</p>
                </div>
            </div>
        </div>
    </footer>
    <script src="/js/admin.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const baseUrl = window.location.origin;
            document.getElementById('last-tip-url').value = `${baseUrl}/widgets/last-tip`;
            document.getElementById('tip-goal-url').value = `${baseUrl}/widgets/tip-goal`;
            document.getElementById('tip-notification-url').value = `${baseUrl}/widgets/tip-notification`;
            document.getElementById('obs-chat-url').value = `${baseUrl}/widgets/chat`;
        });

    function copyToClipboard(elementId) {
    const text = document.getElementById(elementId).value;
    navigator.clipboard.writeText(text).then(() => {
        showCopyToast();
    }).catch(err => {
        console.error('Failed to copy:', err);
        showCopyToast(false);
    });
}

    function showCopyToast(success = true) {
        const toast = document.getElementById('copy-toast');
        const icon = toast.querySelector('.copy-icon');
        const message = toast.querySelector('.copy-message');
        
        if (success) {
            icon.innerHTML = '<path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" />';
            message.textContent = 'URL copied to clipboard!';
            toast.style.borderColor = 'var(--secondary-color)';
        } else {
            icon.innerHTML = '<path fill="currentColor" d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" />';
            message.textContent = 'Failed to copy!';
            toast.style.borderColor = 'var(--error-color)';
        }
        
        toast.classList.add('show');
        
        setTimeout(() => {
            toast.classList.remove('show');
        }, 2000);
    }
    </script>
    <div id="copy-toast" class="copy-toast">
    <svg class="copy-icon" viewBox="0 0 24 24">
        <path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" />
    </svg>
    <span class="copy-message">URL copied to clipboard!</span>
</div>
</body>
</html>